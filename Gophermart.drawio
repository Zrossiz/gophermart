<mxfile host="Electron" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/24.7.5 Chrome/126.0.6478.183 Electron/31.3.0 Safari/537.36" version="24.7.5">
  <diagram name="Страница — 1" id="DOLEwfkjcWHq4bvxf3XI">
    <mxGraphModel dx="1408" dy="740" grid="1" gridSize="7" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="2339" pageHeight="3300" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-1" value="User" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="270" y="560" width="150" height="150" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-2" value="Id (primary key int)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="KpnvzGDNB_tsbz5eWH8U-1" vertex="1">
          <mxGeometry y="30" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-3" value="Name (int)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="KpnvzGDNB_tsbz5eWH8U-1" vertex="1">
          <mxGeometry y="60" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-4" value="Password (string)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="KpnvzGDNB_tsbz5eWH8U-1" vertex="1">
          <mxGeometry y="90" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-5" value="Account (decimal)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="KpnvzGDNB_tsbz5eWH8U-1" vertex="1">
          <mxGeometry y="120" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-6" value="Refresh_token" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="80" y="575" width="140" height="120" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-7" value="Id (primary key int)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="KpnvzGDNB_tsbz5eWH8U-6" vertex="1">
          <mxGeometry y="30" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-8" value="user_id (foreign key int)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="KpnvzGDNB_tsbz5eWH8U-6" vertex="1">
          <mxGeometry y="60" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-9" value="token (string)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="KpnvzGDNB_tsbz5eWH8U-6" vertex="1">
          <mxGeometry y="90" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-11" value="Order" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="720" y="530" width="180" height="180" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-12" value="id (primary key int)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="KpnvzGDNB_tsbz5eWH8U-11" vertex="1">
          <mxGeometry y="30" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-13" value="user_id (foreign key int&amp;nbsp;)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="KpnvzGDNB_tsbz5eWH8U-11" vertex="1">
          <mxGeometry y="60" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-14" value="status_id (foreign key int)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="KpnvzGDNB_tsbz5eWH8U-11" vertex="1">
          <mxGeometry y="90" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-15" value="accrual (decimal)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="KpnvzGDNB_tsbz5eWH8U-11" vertex="1">
          <mxGeometry y="120" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-16" value="processed_at (timestamp)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="KpnvzGDNB_tsbz5eWH8U-11" vertex="1">
          <mxGeometry y="150" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-17" value="Status" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="480" y="780" width="180" height="90" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-18" value="id (primary key int)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="KpnvzGDNB_tsbz5eWH8U-17" vertex="1">
          <mxGeometry y="30" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-22" value="status (string)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="KpnvzGDNB_tsbz5eWH8U-17" vertex="1">
          <mxGeometry y="60" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-23" value="Balance_history" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="480" y="350" width="180" height="150" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-24" value="id (primary key int)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="KpnvzGDNB_tsbz5eWH8U-23" vertex="1">
          <mxGeometry y="30" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-25" value="user_id (foreign key int)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="KpnvzGDNB_tsbz5eWH8U-23" vertex="1">
          <mxGeometry y="60" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-26" value="order_id (foreign key int)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="KpnvzGDNB_tsbz5eWH8U-23" vertex="1">
          <mxGeometry y="90" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-27" value="change (decimal)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="KpnvzGDNB_tsbz5eWH8U-23" vertex="1">
          <mxGeometry y="120" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-28" value="" style="edgeStyle=entityRelationEdgeStyle;fontSize=12;html=1;endArrow=ERmandOne;startArrow=ERmandOne;rounded=0;entryX=0.013;entryY=0.693;entryDx=0;entryDy=0;entryPerimeter=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="KpnvzGDNB_tsbz5eWH8U-8" target="KpnvzGDNB_tsbz5eWH8U-2" edge="1">
          <mxGeometry width="100" height="100" relative="1" as="geometry">
            <mxPoint x="260" y="760" as="sourcePoint" />
            <mxPoint x="360" y="660" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-29" value="" style="edgeStyle=entityRelationEdgeStyle;fontSize=12;html=1;endArrow=ERoneToMany;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="KpnvzGDNB_tsbz5eWH8U-2" target="KpnvzGDNB_tsbz5eWH8U-13" edge="1">
          <mxGeometry width="100" height="100" relative="1" as="geometry">
            <mxPoint x="400" y="760" as="sourcePoint" />
            <mxPoint x="500" y="660" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-30" value="" style="edgeStyle=entityRelationEdgeStyle;fontSize=12;html=1;endArrow=ERmandOne;startArrow=ERmandOne;rounded=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="KpnvzGDNB_tsbz5eWH8U-14" target="KpnvzGDNB_tsbz5eWH8U-18" edge="1">
          <mxGeometry width="100" height="100" relative="1" as="geometry">
            <mxPoint x="570" y="720" as="sourcePoint" />
            <mxPoint x="670" y="620" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-31" value="" style="edgeStyle=entityRelationEdgeStyle;fontSize=12;html=1;endArrow=ERoneToMany;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="KpnvzGDNB_tsbz5eWH8U-2" target="KpnvzGDNB_tsbz5eWH8U-25" edge="1">
          <mxGeometry width="100" height="100" relative="1" as="geometry">
            <mxPoint x="650" y="680" as="sourcePoint" />
            <mxPoint x="750" y="580" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-32" value="" style="edgeStyle=entityRelationEdgeStyle;fontSize=12;html=1;endArrow=ERmandOne;startArrow=ERmandOne;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="KpnvzGDNB_tsbz5eWH8U-26" target="KpnvzGDNB_tsbz5eWH8U-12" edge="1">
          <mxGeometry width="100" height="100" relative="1" as="geometry">
            <mxPoint x="650" y="660" as="sourcePoint" />
            <mxPoint x="750" y="560" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-33" value="&lt;font style=&quot;font-size: 40px;&quot;&gt;Схема базы данных&lt;/font&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="350" y="90" width="430" height="150" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-34" value="&lt;font style=&quot;font-size: 40px;&quot;&gt;Архитектура приложения&lt;/font&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="297.5" y="966" width="505" height="150" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-58" value="В приложении я стараюсь соблюдать принципы гексогональной архитектуры и некоторые принципы SOLID. Ниже описаны преимущества такого подхода&lt;div&gt;&lt;br&gt;&lt;div&gt;1. Модульность и разделение обязанностей&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; Проект разделен на слои, каждый из них отвечает за свой аспект функционала&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;2. Переиспользование кода&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; Создание абстрактного типа Storage упрощает управление зависимостями. Разные&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; модули приложения могут использовать тип Storage, получая доступ к нужным&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; хранилищам через единный интерфейс&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;3. Легкость в тестировании&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; Использование интерфейсов для каждого слоя позволяет легко создавать моковые&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; данные для тестирования. Благодаря этому подходу мы можем реализовать модульное&amp;nbsp; &amp;nbsp; &amp;nbsp; тестирование&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;4. Гибкость и расширяемость&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; Добавление новой сущности или новой операции не требует значительных изменений.&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Достаточно создать новый Store и добавить его в Storage структуру. Разделение логики&amp;nbsp; &amp;nbsp; &amp;nbsp; в transport позволяет быстро добавить методы для взаимодействия с rpc протоколами.&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Разделение логики в storage слое позволяет гибко работать с базами данных&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;5. Поддерживаемость и читаемость&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; Структура проекта способствует низкому порогу входа новых разработчиков в проект.&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Т.к все слои изолированы друг от друга - поиск нужного кода становится простой&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; задачей&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;6. Соответствие принципов SOLID&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; 6.1&amp;nbsp;&lt;strong style=&quot;background-color: initial;&quot;&gt;Single Responsibility Principle (SRP)&lt;/strong&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;: Каждый Store и обработчик выполняет&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; единственную задачу.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; 6.2&amp;nbsp;&lt;/span&gt;&lt;strong style=&quot;background-color: initial;&quot;&gt;Open/Closed Principle (OCP)&lt;/strong&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;: Можно добавлять новые типы хранилищ или&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; обработчиков, не изменяя существующий код.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; 6.3&amp;nbsp;&lt;/span&gt;&lt;strong style=&quot;background-color: initial;&quot;&gt;Dependency Inversion Principle (DIP)&lt;/strong&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;: Код верхнего уровня зависит от абстракций (например, интерфейсов хранилищ), а не от конкретных реализаций.&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="287" y="1093" width="526" height="557" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-62" value="&lt;font style=&quot;font-size: 40px;&quot;&gt;Описание работы хендлеров&lt;/font&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1421" y="105" width="630" height="150" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-64" value="&lt;div&gt;&lt;div&gt;build&lt;/div&gt;&lt;div&gt;|-- Dockerfile&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Dockerfile для создания образа приложения&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;cmd&lt;/div&gt;&lt;div&gt;|-- accrual&lt;/div&gt;&lt;div&gt;|-- gophermart&lt;/div&gt;&lt;div&gt;|&amp;nbsp; &amp;nbsp;|- main.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // Главный файл запуска приложения&lt;/div&gt;&lt;div&gt;|-- migrator&lt;/div&gt;&lt;div&gt;|&amp;nbsp; &amp;nbsp;|- migrator.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Файл для запуска миграций базы данных&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;deployments&lt;/div&gt;&lt;div&gt;|-- docker-compose.yml&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Файл для управления контейнерами с помощью Docker Compose&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;internal&lt;/div&gt;&lt;div&gt;|-- app&lt;/div&gt;&lt;div&gt;|&amp;nbsp; &amp;nbsp;|- app.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // Основная конфигурация и запуск веб-сервера&lt;/div&gt;&lt;div&gt;|-- config&lt;/div&gt;&lt;div&gt;|&amp;nbsp; &amp;nbsp;|- config.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Парсинг конфигураций из .env или флагов приложения&lt;/div&gt;&lt;div&gt;|-- dto&lt;/div&gt;&lt;div&gt;|&amp;nbsp; &amp;nbsp;|- dto.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // Определение DTO для общения через REST (http)&lt;/div&gt;&lt;div&gt;|-- middleware&lt;/div&gt;&lt;div&gt;|&amp;nbsp; &amp;nbsp;|- middleware.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Middleware, например, для проверки аутентификации JWT&lt;/div&gt;&lt;div&gt;|-- model&lt;/div&gt;&lt;div&gt;|&amp;nbsp; &amp;nbsp;|- model.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // Определение моделей данных для работы с базой данных&lt;/div&gt;&lt;div&gt;|-- service&lt;/div&gt;&lt;div&gt;|&amp;nbsp; &amp;nbsp;|- balancehistory.go&amp;nbsp; &amp;nbsp; &amp;nbsp;// Логика обработки данных истории баланса&lt;/div&gt;&lt;div&gt;|&amp;nbsp; &amp;nbsp;|- order.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // Логика обработки данных заказов&lt;/div&gt;&lt;div&gt;|&amp;nbsp; &amp;nbsp;|- refreshtoken.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Логика работы с токенами обновления&lt;/div&gt;&lt;div&gt;|&amp;nbsp; &amp;nbsp;|- service.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // Основные сервисы приложения&lt;/div&gt;&lt;div&gt;|&amp;nbsp; &amp;nbsp;|- status.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Логика работы со статусами&lt;/div&gt;&lt;div&gt;|&amp;nbsp; &amp;nbsp;|- user.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Логика обработки данных пользователей&lt;/div&gt;&lt;div&gt;|-- storage&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; |-- postgresql&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; |- balancehistory.go // Хранение данных истории баланса в PostgreSQL&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; |- order.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // Хранение данных заказов в PostgreSQL&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; |- postgresql.go&amp;nbsp; &amp;nbsp; &amp;nbsp;// Основной файл для работы с PostgreSQL&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; |- refreshtoken.go&amp;nbsp; &amp;nbsp;// Хранение данных токенов обновления в PostgreSQL&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; |- status.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Хранение данных статусов в PostgreSQL&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; |- user.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Хранение данных пользователей в PostgreSQL&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;|-- transport&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; |-- http&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; |-- handler&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; |&amp;nbsp; &amp;nbsp;|- balancehistory.go // Обработчик HTTP-запросов для истории баланса&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; |&amp;nbsp; &amp;nbsp;|- handler.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // Основной файл с обработчиками HTTP-запросов&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; |&amp;nbsp; &amp;nbsp;|- order.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // Обработчик HTTP-запросов для заказов&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; |&amp;nbsp; &amp;nbsp;|- status.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Обработчик HTTP-запросов для статусов&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; |&amp;nbsp; &amp;nbsp;|- user.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Обработчик HTTP-запросов для пользователей&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; |&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; |-- router&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; |- balancehistory.go // Определение маршрутов для истории баланса&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; |- order.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // Определение маршрутов для заказов&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; |- router.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Основной файл маршрутизации HTTP-запросов&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; |- status.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Определение маршрутов для статусов&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; |- user.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Определение маршрутов для пользователей&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;migration&lt;/div&gt;&lt;div&gt;|-- 1_init.sql&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// SQL-файл для начальных миграций базы данных&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;pkg&lt;/div&gt;&lt;div&gt;|-- logger&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; |- logger.go&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Логика для логирования в приложении&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;|-- .gitignore&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Игнорируемые файлы и директории для Git&lt;/div&gt;&lt;div&gt;|-- go.mod&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Модуль Go с зависимостями проекта&lt;/div&gt;&lt;div&gt;|-- go.sum&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Контрольные суммы зависимостей проекта&lt;/div&gt;&lt;div&gt;|-- README.md&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // Документация и описание проекта&lt;/div&gt;&lt;div&gt;|-- SPECIFICATION.md&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Спецификация приложения&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="287" y="1656" width="868" height="1012" as="geometry" />
        </mxCell>
        <mxCell id="KpnvzGDNB_tsbz5eWH8U-65" value="&lt;font style=&quot;font-size: 30px;&quot;&gt;Регистрация&lt;/font&gt;&lt;div style=&quot;font-size: 30px;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;br&gt;1. Пользователь отправляет запрос на /api/user/register&lt;/font&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;2. Д&lt;span style=&quot;background-color: initial;&quot;&gt;анные валидируются на сервере&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;3. Хешируется пароль&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;4. Создается запись в бд c новым пользователем&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;5. Генерируется access token&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;6. Генерируется refresh token&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;7. Создается запись в бд с новым refresh токеном, привязанным к пользователю&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;8. Устанавливается refresh token в куки (httpOnly = true)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;9. Устанавливается access token в куки (httpOnly = false)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;10. Отправляется ответ&lt;br&gt;&lt;br&gt;Статус коды:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;ul style=&quot;margin-top: 0px; margin-bottom: 0.7em; position: relative; color: rgb(204, 204, 204); font-family: -apple-system, &amp;quot;system-ui&amp;quot;, &amp;quot;Segoe WPC&amp;quot;, &amp;quot;Segoe UI&amp;quot;, system-ui, Ubuntu, &amp;quot;Droid Sans&amp;quot;, sans-serif;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;91&quot;&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;91&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;200&lt;/code&gt;&amp;nbsp;— пользователь успешно зарегистрирован и аутентифицирован;&lt;/font&gt;&lt;/li&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;92&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;400&lt;/code&gt;&amp;nbsp;— неверный формат запроса;&lt;/font&gt;&lt;/li&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;93&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;409&lt;/code&gt;&amp;nbsp;— логин уже занят;&lt;/font&gt;&lt;/li&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;94&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;500&lt;/code&gt;&amp;nbsp;— внутренняя ошибка сервера.&lt;/font&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; style=&quot;font-size: 14px;&quot; color=&quot;#cccccc&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; style=&quot;font-size: 30px;&quot; color=&quot;#cccccc&quot;&gt;Логин&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; style=&quot;font-size: 14px;&quot; color=&quot;#cccccc&quot;&gt;&lt;br&gt;1. Пользователь отправляет запрос на /api/user/login&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; style=&quot;font-size: 14px;&quot; color=&quot;#cccccc&quot;&gt;2. Данные валидируются на сервере&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; style=&quot;font-size: 14px;&quot; color=&quot;#cccccc&quot;&gt;3. Находим пользователя в бд&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; style=&quot;font-size: 14px;&quot; color=&quot;#cccccc&quot;&gt;4. Хешируем пароль пользователя и сравниваем с хешем из бд&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;5. Генерируется access token&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;6. Генерируется refresh token&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;7. Создается запись в бд с новым refresh токеном, привязанным к пользователю&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;8. Устанавливается refresh token в куки (httpOnly = true)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;9. Устанавливается access token в куки (httpOnly = false)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;10. Отправляется ответ&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;Статус коды:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;ul style=&quot;margin-top: 0px; margin-bottom: 0.7em; position: relative; color: rgb(204, 204, 204); font-family: -apple-system, &amp;quot;system-ui&amp;quot;, &amp;quot;Segoe WPC&amp;quot;, &amp;quot;Segoe UI&amp;quot;, system-ui, Ubuntu, &amp;quot;Droid Sans&amp;quot;, sans-serif;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;117&quot;&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;117&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;200&lt;/code&gt;&amp;nbsp;— пользователь успешно аутентифицирован;&lt;/font&gt;&lt;/li&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;118&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;400&lt;/code&gt;&amp;nbsp;— неверный формат запроса;&lt;/font&gt;&lt;/li&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;119&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;401&lt;/code&gt;&amp;nbsp;— неверная пара логин/пароль;&lt;/font&gt;&lt;/li&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;120&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;500&lt;/code&gt;&amp;nbsp;— внутренняя ошибка сервера;&lt;/font&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; style=&quot;font-size: 14px;&quot; color=&quot;#cccccc&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; style=&quot;font-size: 30px;&quot; color=&quot;#cccccc&quot;&gt;&lt;b&gt;Проверка refresh токена&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; style=&quot;font-size: 30px;&quot; color=&quot;#cccccc&quot;&gt;&lt;br&gt;1. Пользователь отправляет запрос на /api/user/verify&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; style=&quot;font-size: 14px;&quot; color=&quot;#cccccc&quot;&gt;2. Принимается refresh токен из куки&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; style=&quot;font-size: 14px;&quot; color=&quot;#cccccc&quot;&gt;3. Ищем запись с refresh токеном в бд&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; style=&quot;font-size: 14px;&quot; color=&quot;#cccccc&quot;&gt;4. Смотрим - не протух ли токен из бд&lt;br&gt;5. Сравниваем два токена&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;6. Генерируется access token&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;7. Генерируется refresh token&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;8. Перезаписывается запись в бд с новым refresh токеном, привязанным к пользователю&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;9. Устанавливается refresh token в куки (httpOnly = true)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;10. Устанавливается access token в куки (httpOnly = false)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;11. Отправляется ответ&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;Статус коды:&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;ul style=&quot;margin-top: 0px; margin-bottom: 0.7em; position: relative; color: rgb(204, 204, 204); font-family: -apple-system, &amp;quot;system-ui&amp;quot;, &amp;quot;Segoe WPC&amp;quot;, &amp;quot;Segoe UI&amp;quot;, system-ui, Ubuntu, &amp;quot;Droid Sans&amp;quot;, sans-serif;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;117&quot;&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;117&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;200&lt;/code&gt;&amp;nbsp;— пользователь успешно аутентифицирован;&lt;/li&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;118&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;400&lt;/code&gt;&amp;nbsp;— неверный формат запроса;&lt;/li&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;119&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;401&lt;/code&gt;&amp;nbsp;— ошибка проверки токена;&lt;/li&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;120&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;500&lt;/code&gt;&amp;nbsp;— внутренняя ошибка сервера;&lt;/li&gt;&lt;/ul&gt;&lt;div&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 30px;&quot; face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;&lt;b&gt;Получение списка загруженных номеров заказа&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 30px;&quot; face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;1. Пользователь отправляет запрос на /api/user/orders&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;2. Проверяем возможность пользователя на получения данных (jwt middleware)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;3. Достаем из jwt payload id пользователя и кладем его в контекст&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;4. Получаем все записи пользователя из таблицы orders по user id из бд&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;5. Отправляется ответ&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;Статус коды:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;ul style=&quot;margin-top: 0px; margin-bottom: 0.7em; position: relative; color: rgb(204, 204, 204); font-family: -apple-system, &amp;quot;system-ui&amp;quot;, &amp;quot;Segoe WPC&amp;quot;, &amp;quot;Segoe UI&amp;quot;, system-ui, Ubuntu, &amp;quot;Droid Sans&amp;quot;, sans-serif;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;172&quot;&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line code-active-line&quot; data-line=&quot;201&quot;&gt;&lt;p style=&quot;margin-top: 0px; margin-bottom: 0.7em; position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;201&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; font-size: 1em; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;200&lt;/code&gt;&amp;nbsp;— успешная обработка запроса.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;ul style=&quot;margin-top: 0px; margin-bottom: 0.7em; position: relative; color: rgb(204, 204, 204); font-family: -apple-system, &amp;quot;system-ui&amp;quot;, &amp;quot;Segoe WPC&amp;quot;, &amp;quot;Segoe UI&amp;quot;, system-ui, Ubuntu, &amp;quot;Droid Sans&amp;quot;, sans-serif;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;172&quot;&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line code-active-line&quot; data-line=&quot;201&quot;&gt;&lt;p style=&quot;margin-top: 0px; margin-bottom: 0.7em; position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;201&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; font-size: 1em; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;204&lt;/code&gt;&amp;nbsp;— нет данных для ответа.&lt;/p&gt;&lt;/li&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;202&quot;&gt;&lt;p style=&quot;margin-top: 0px; margin-bottom: 0.7em; position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;202&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; font-size: 1em; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;401&lt;/code&gt;&amp;nbsp;— пользователь не авторизован.&lt;/p&gt;&lt;/li&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;203&quot;&gt;&lt;p style=&quot;margin-top: 0px; margin-bottom: 0.7em; position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;203&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; font-size: 1em; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;500&lt;/code&gt;&amp;nbsp;— внутренняя ошибка сервера.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 30px;&quot; face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;&lt;b&gt;Получение текущего баланса пользователя&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 30px;&quot; face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;div&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;1. Пользователь отправляет запрос на /api/user/balance&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;2. Проверяем возможность пользователя на получения данных (jwt middleware)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;3. Достаем из jwt payload id пользователя и кладем его в контекст&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;4. Получаем запись пользователя из бд по user_id (берем оттуда свойство account)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;5. Делаем запрос к бд с подсчетом всех трат пользователя за все время из таблицы balance_history&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;6. Отправляется ответ&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;Статус коды:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;ul style=&quot;margin-top: 0px; margin-bottom: 0.7em; position: relative; color: rgb(204, 204, 204); font-family: -apple-system, &amp;quot;system-ui&amp;quot;, &amp;quot;Segoe WPC&amp;quot;, &amp;quot;Segoe UI&amp;quot;, system-ui, Ubuntu, &amp;quot;Droid Sans&amp;quot;, sans-serif;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;220&quot;&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;220&quot;&gt;&lt;p style=&quot;margin-top: 0px; margin-bottom: 0.7em; position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;220&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; font-size: 1em; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;200&lt;/code&gt;&amp;nbsp;— успешная обработка запроса.&lt;/p&gt;&lt;/li&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;235&quot;&gt;&lt;p style=&quot;margin-top: 0px; margin-bottom: 0.7em; position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;235&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; font-size: 1em; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;401&lt;/code&gt;&amp;nbsp;— пользователь не авторизован.&lt;/p&gt;&lt;/li&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;236&quot;&gt;&lt;p style=&quot;margin-top: 0px; margin-bottom: 0.7em; position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;236&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; font-size: 1em; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;500&lt;/code&gt;&amp;nbsp;— внутренняя ошибка сервера.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 30px;&quot; face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;&lt;b&gt;Запрос на списание средств&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 30px;&quot; face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;div&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;1. Пользователь отправляет запрос на /api/user/balance/withdraw&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;2. Проверяем возможность пользователя на получения данных (jwt middleware)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;3. Достаем из jwt payload id пользователя и кладем его в контекст&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;4. Валидируем данные&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;5. Стартуем транзакцию&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;6. Смотрим - хватает ли средств у пользователя&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;7. Списываем средства у пользователя с его account&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;8. Создаем запись в бд со списанием - таблица balance_history&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;9. Отправляется ответ&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;Статус коды:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;ul style=&quot;margin-top: 0px; margin-bottom: 0.7em; position: relative; color: rgb(204, 204, 204); font-family: -apple-system, &amp;quot;system-ui&amp;quot;, &amp;quot;Segoe WPC&amp;quot;, &amp;quot;Segoe UI&amp;quot;, system-ui, Ubuntu, &amp;quot;Droid Sans&amp;quot;, sans-serif;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;262&quot;&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;262&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; font-size: 1em; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;200&lt;/code&gt;&amp;nbsp;— успешная обработка запроса;&lt;/li&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;263&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; font-size: 1em; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;401&lt;/code&gt;&amp;nbsp;— пользователь не авторизован;&lt;/li&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;264&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; font-size: 1em; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;402&lt;/code&gt;&amp;nbsp;— на счету недостаточно средств;&lt;/li&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;265&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; font-size: 1em; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;422&lt;/code&gt;&amp;nbsp;— неверный номер заказа;&lt;/li&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;266&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; font-size: 1em; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;500&lt;/code&gt;&amp;nbsp;— внутренняя ошибка сервера.&lt;/li&gt;&lt;/ul&gt;&lt;div&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 30px;&quot; face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;&lt;b&gt;Получение информации о списании средств&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;div&gt;&lt;font style=&quot;font-size: 30px;&quot; face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot; face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;1. Пользователь отправляет запрос на /api/user/withdrawls&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot; face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;2. Проверяем возможность пользователя на получения данных (jwt middleware)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot; face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;3. Достаем из jwt payload id пользователя и кладем его в контекст&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;4. Получаем все записи по user id из таблицы balance_history и сортируем от новых к старым&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;5. Отправляется ответ&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;Статус коды:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;ul style=&quot;margin-top: 0px; margin-bottom: 0.7em; position: relative; color: rgb(204, 204, 204); font-family: -apple-system, &amp;quot;system-ui&amp;quot;, &amp;quot;Segoe WPC&amp;quot;, &amp;quot;Segoe UI&amp;quot;, system-ui, Ubuntu, &amp;quot;Droid Sans&amp;quot;, sans-serif;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;283&quot;&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;283&quot;&gt;&lt;p style=&quot;margin-top: 0px; margin-bottom: 0.7em; position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;283&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; font-size: 1em; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;200&lt;/code&gt;&amp;nbsp;— успешная обработка запроса.&lt;/p&gt;&lt;/li&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;301&quot;&gt;&lt;p style=&quot;margin-top: 0px; margin-bottom: 0.7em; position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;301&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; font-size: 1em; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;204&lt;/code&gt;&amp;nbsp;- нет ни одного списания.&lt;/p&gt;&lt;/li&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;302&quot;&gt;&lt;p style=&quot;margin-top: 0px; margin-bottom: 0.7em; position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;302&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; font-size: 1em; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;401&lt;/code&gt;&amp;nbsp;— пользователь не авторизован.&lt;/p&gt;&lt;/li&gt;&lt;li style=&quot;position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;303&quot;&gt;&lt;p style=&quot;margin-top: 0px; margin-bottom: 0.7em; position: relative;&quot; dir=&quot;auto&quot; class=&quot;code-line&quot; data-line=&quot;303&quot;&gt;&lt;code style=&quot;color: var(--vscode-textPreformat-foreground); background-color: var(--vscode-textPreformat-background); padding: 1px 3px; border-radius: 4px; font-size: 1em; line-height: 1.357em; font-family: var(--vscode-editor-font-family, &amp;quot;SF Mono&amp;quot;, Monaco, Menlo, Consolas, &amp;quot;Ubuntu Mono&amp;quot;, &amp;quot;Liberation Mono&amp;quot;, &amp;quot;DejaVu Sans Mono&amp;quot;, &amp;quot;Courier New&amp;quot;, monospace);&quot;&gt;500&lt;/code&gt;&amp;nbsp;— внутренняя ошибка сервера.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; color=&quot;#cccccc&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; style=&quot;font-size: 30px;&quot; color=&quot;#cccccc&quot;&gt;&lt;b&gt;Получение информации о расчете начислений баллов лояльности&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 20px;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; style=&quot;font-size: 20px;&quot; color=&quot;#cccccc&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font face=&quot;-apple-system, system-ui, Segoe WPC, Segoe UI, system-ui, Ubuntu, Droid Sans, sans-serif&quot; style=&quot;font-size: 20px;&quot; color=&quot;#cccccc&quot;&gt;Сервер будет непрерывно отправлять запросы на получение информации о каждом ордере со статусами &quot;REGISTERED&quot; или &quot;PROCESS&quot;, пока не привысит rate limit черного ящика. После превышения rate limit - сервер уходит в сон на время до следующей попытки. Время следующей попытки будет указано в ответе от черного ящика&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1330" y="224" width="1197" height="3598" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
